<Window
    x:Class="OpticaPro.Views.OptotypeWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Optotipo Digital Clínico - OpticaPro">

    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Background="White" BorderBrush="#F0F0F0" BorderThickness="0,0,0,2" Padding="16,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Spacing="16" VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE721;" Foreground="#0078D7"/>
                    <TextBlock Text="Panel de Control" FontWeight="SemiBold" VerticalAlignment="Center"/>
                </StackPanel>

                <Rectangle Width="1" Height="20" Fill="#E0E0E0"/>

                <ComboBox x:Name="CmbDistance" SelectedIndex="0" SelectionChanged="CmbDistance_SelectionChanged" Width="120" VerticalAlignment="Center" ToolTipService.ToolTip="Distancia Paciente-Pantalla">
                    <ComboBoxItem Content="6 Metros"/>
                    <ComboBoxItem Content="3 Metros"/>
                </ComboBox>

                <ComboBox x:Name="CmbType" SelectedIndex="0" SelectionChanged="CmbType_SelectionChanged" Width="180" VerticalAlignment="Center">
                    <ComboBoxItem Content="Letras (Snellen)"/>
                    <ComboBoxItem Content="Números"/>
                    <ComboBoxItem Content="E Direccional"/>
                    <ComboBoxItem Content="Figuras (Niños)"/>
                </ComboBox>
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                <CommandBar DefaultLabelPosition="Collapsed" Background="Transparent" IsOpen="False">
                    <AppBarButton Icon="ZoomIn" Label="Aumentar" Click="BtnZoomOut_Click" ToolTipService.ToolTip="Aumentar Tamaño [↓]"/>
                    <AppBarButton Icon="ZoomOut" Label="Disminuir" Click="BtnZoomIn_Click" ToolTipService.ToolTip="Disminuir Tamaño [↑]"/>
                    <AppBarSeparator/>
                    <AppBarButton Icon="Shuffle" Label="Aleatorio" Click="BtnRandom_Click" ToolTipService.ToolTip="Aleatorio [Espacio]"/>
                    <AppBarSeparator/>
                    <AppBarToggleButton x:Name="TglDuochrome" Icon="ShowBcc" Label="Filtro R/V" Click="TglDuochrome_Toggled" ToolTipService.ToolTip="Test Duocromo R/V"/>
                    <AppBarSeparator/>
                    <AppBarButton Icon="FullScreen" Label="Pantalla Completa" Click="BtnFullscreen_Click" ToolTipService.ToolTip="Pantalla Completa [F11]"/>
                </CommandBar>
            </StackPanel>
        </Grid>

        <Grid Grid.Row="1" x:Name="ProjectionGrid">

            <Grid x:Name="DuochromeLayer" Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Border Grid.Column="0" Background="#FF6666"/>
                <Border Grid.Column="1" Background="#66FF66"/>
            </Grid>

            <Viewbox x:Name="MainViewbox" Stretch="Uniform" Margin="50">
                <ItemsControl x:Name="OptotypeList">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="40"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Character}" 
                                       FontSize="100"
                                       FontFamily="Segoe UI Symbol" 
                                       FontWeight="Bold" 
                                       Foreground="Black"
                                       RenderTransformOrigin="0.5,0.5">
                                <TextBlock.RenderTransform>
                                    <RotateTransform Angle="{Binding Angle}"/>
                                </TextBlock.RenderTransform>
                            </TextBlock>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Viewbox>

            <Border VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="40" 
                    Background="White" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="12" Padding="16,8">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <FontIcon Glyph="&#xE7B3;" Foreground="#0078D7" FontSize="20" VerticalAlignment="Center"/>
                    <StackPanel>
                        <TextBlock Text="AGUDEZA VISUAL" FontSize="10" Foreground="Gray" FontWeight="SemiBold"/>
                        <TextBlock x:Name="LblAcuity" Text="20/200" Foreground="#333333" FontSize="28" FontWeight="Bold" LineHeight="28"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="20" Opacity="0.6">
                <FontIcon Glyph="&#xE92E;" FontSize="12"/>
                <TextBlock Text="Atajos: ↑ ↓ Tamaño | Espacio: Aleatorio | F11: Fullscreen" FontSize="12"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>